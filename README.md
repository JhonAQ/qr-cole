# üìö EduCheck Fe y Ciencia - Documentaci√≥n T√©cnica Integral

## üéØ Resumen Ejecutivo

**EduCheck Fe y Ciencia** es un sistema integral de gesti√≥n de asistencia escolar desarrollado con tecnolog√≠as web modernas, dise√±ado espec√≠ficamente para instituciones educativas que requieren un control eficiente y automatizado de la asistencia estudiantil mediante c√≥digos QR √∫nicos.

### Datos del Proyecto

- **Nombre**: EduCheck Fe y Ciencia
- **Tipo**: Sistema de Control de Asistencia Escolar
- **Tecnolog√≠a Principal**: Next.js 15.4.6 + React 19.1
- **Base de Datos**: Supabase (PostgreSQL)
- **Interfaz**: Responsive Web Application (PWA Ready)
- **Estado**: En desarrollo activo
- **Licencia**: Privada - Colegio Fe y Ciencia

---

## üèóÔ∏è Arquitectura del Sistema

### Stack Tecnol√≥gico

#### Frontend

- **Framework**: Next.js 15.4.6 con App Router
- **Runtime**: React 19.1 con TypeScript 5.x
- **Styling**: Tailwind CSS 4.x
- **Animaciones**: Framer Motion 12.23.12
- **Componentes UI**: Lucide React (iconos)
- **Notificaciones**: React Hot Toast
- **Gr√°ficos**: Recharts 3.1.2

#### Backend & Base de Datos

- **BaaS**: Supabase (Backend as a Service)
- **Base de Datos**: PostgreSQL (via Supabase)
- **Autenticaci√≥n**: Supabase Auth
- **Almacenamiento**: Supabase Storage
- **Real-time**: Supabase Realtime

#### Librer√≠as Especializadas

- **QR Scanning**: html5-qrcode 2.3.8
- **QR Generation**: qrcode 1.5.4
- **PDF Export**: jsPDF 3.0.1 + jsPDF-AutoTable 5.0.2
- **Excel Export**: xlsx 0.18.5

### Arquitectura de Capas

```mermaid
graph TB
    A[Presentaci√≥n - Next.js/React] --> B[L√≥gica de Negocio - Context/Hooks]
    B --> C[Servicios - API Routes]
    C --> D[Datos - Supabase]

    A --> E[Componentes UI]
    A --> F[Scanner QR]
    A --> G[Generador QR]

    B --> H[WhatsApp Integration]
    B --> I[PDF/Excel Export]

    D --> J[PostgreSQL]
    D --> K[Auth Service]
    D --> L[Real-time Subscriptions]
```

---

## üé≠ M√≥dulos y Funcionalidades

### 1. **M√≥dulo de Autenticaci√≥n**

- **Ubicaci√≥n**: `src/app/page.tsx`
- **Funcionalidades**:
  - Login con email/password
  - Recuperaci√≥n de contrase√±a
  - Sesi√≥n persistente con localStorage
  - Validaci√≥n de formularios en tiempo real
  - Redirecci√≥n autom√°tica post-autenticaci√≥n

### 2. **Dashboard Principal**

- **Ubicaci√≥n**: `src/app/dashboard/page.tsx`
- **Caracter√≠sticas**:
  - Interfaz responsive multi-dispositivo
  - 7 m√≥dulos especializados integrados
  - Navegaci√≥n por tabs din√°mica
  - Context API para estado global
  - Lazy loading de componentes

#### 2.1 **M√≥dulo Resumen (Overview)**

- **Archivo**: `src/components/Dashboard/OverviewTab.tsx`
- **Funciones**:
  - Dashboard ejecutivo con KPIs
  - Estad√≠sticas en tiempo real
  - Gr√°ficos de asistencia
  - Navegaci√≥n r√°pida a otros m√≥dulos

#### 2.2 **M√≥dulo de Estudiantes (Alumnos)**

- **Archivo**: `src/components/Dashboard/AlumnosTab.tsx`
- **Funciones**:
  - Listado completo de estudiantes
  - Vista de cuadr√≠cula y lista
  - Filtrado por grado, secci√≥n, estado
  - B√∫squeda en tiempo real
  - Modal de detalles de estudiante

#### 2.3 **M√≥dulo de Registro de Estudiantes**

- **Archivo**: `src/components/QRGenerator.tsx`
- **Funciones**:
  - Registro de nuevos estudiantes
  - Generaci√≥n autom√°tica de c√≥digos QR √∫nicos
  - Validaci√≥n de datos duplicados
  - Vista previa del QR generado
  - Descarga de c√≥digos QR

#### 2.4 **M√≥dulo Scanner QR**

- **Ubicaci√≥n**: `src/components/Scanner/`
- **Componentes**:
  - `EnhancedQRScanner.tsx`: Scanner principal
  - `ScannerCamera.tsx`: Control de c√°mara
  - `StudentConfirmation.tsx`: Confirmaci√≥n de asistencia
  - `RecentRegistrations.tsx`: Registros recientes
- **Funciones**:
  - Escaneo QR en tiempo real
  - Detecci√≥n autom√°tica de tipo (entrada/salida)
  - Prevenci√≥n de registros duplicados
  - Soporte multi-c√°mara
  - Confirmaci√≥n visual del estudiante

#### 2.5 **M√≥dulo de Registros de Asistencia**

- **Archivo**: `src/components/Dashboard/AsistenciaTab.tsx`
- **Funciones**:
  - Historial completo de asistencias
  - Filtrado por fechas, tipos, grados
  - Vista de lista y cuadr√≠cula
  - Exportaci√≥n de reportes (PDF, Excel, CSV)
  - Estad√≠sticas de asistencia

#### 2.6 **M√≥dulo de Control de Asistencia** ‚≠ê

- **Archivo**: `src/components/Dashboard/ControlAsistenciaTab.tsx`
- **Funciones Principales**:
  - **Vista Profesor**: Control por grado y secci√≥n espec√≠fica
  - **Vista Directivo**: Acceso a todos los grados
  - Navegaci√≥n din√°mica por grado/secci√≥n
  - Identificaci√≥n de ausentes en tiempo real
  - Sistema de alertas configurables
  - Env√≠o manual de notificaciones WhatsApp
  - Configuraci√≥n de horarios (entrada: 8:00, salida: 15:15)
  - Tiempo de gracia: 20 minutos
  - Alertas autom√°ticas despu√©s de 20 minutos

#### 2.7 **M√≥dulo de Estad√≠sticas**

- **Archivo**: `src/components/Dashboard/EstadisticasTab.tsx`
- **Funciones**:
  - Gr√°ficos de asistencia por per√≠odo
  - M√©tricas de rendimiento
  - Comparativas por grado/secci√≥n
  - Tendencias hist√≥ricas

### 3. **Sistema de Notificaciones WhatsApp**

- **Hook**: `src/hooks/useWhatsAppNotification.ts`
- **Componentes**:
  - `WhatsAppModal.tsx`: Modal de confirmaci√≥n
  - `QuickWhatsAppNotification.tsx`: Notificaci√≥n r√°pida
- **API Route**: `src/app/api/whatsapp/route.ts`
- **Funciones**:
  - Generaci√≥n de enlaces WhatsApp Web
  - Mensajes personalizables por contexto
  - Integraci√≥n con API de WhatsApp Business (preparado)
  - Env√≠o manual a padres de familia

---

## üóÑÔ∏è Esquema de Base de Datos

### Tabla: `alumnos`

```sql
CREATE TABLE alumnos (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  nombres VARCHAR NOT NULL,
  apellidos VARCHAR NOT NULL,
  dni VARCHAR UNIQUE NOT NULL,
  nombres_apoderado VARCHAR NOT NULL,
  codigo_qr VARCHAR UNIQUE NOT NULL,
  contacto_padres VARCHAR,
  grado INTEGER NOT NULL,
  seccion VARCHAR NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### Tabla: `asistencias`

```sql
CREATE TABLE asistencias (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  id_alumno UUID REFERENCES alumnos(id) ON DELETE CASCADE,
  hora TIMESTAMP DEFAULT NOW(),
  tipo VARCHAR CHECK (tipo IN ('entrada', 'salida')),
  created_at TIMESTAMP DEFAULT NOW()
);
```

### √çndices y Optimizaciones

```sql
-- √çndices para mejores consultas
CREATE INDEX idx_asistencias_alumno_fecha ON asistencias(id_alumno, DATE(hora));
CREATE INDEX idx_asistencias_fecha_tipo ON asistencias(DATE(hora), tipo);
CREATE INDEX idx_alumnos_grado_seccion ON alumnos(grado, seccion);
CREATE INDEX idx_alumnos_codigo_qr ON alumnos(codigo_qr);
```

---

## üîÑ Flujo de Datos y Procesos

### Workflow de Registro de Estudiantes

```mermaid
sequenceDiagram
    participant U as Usuario
    participant F as Frontend
    participant S as Supabase

    U->>F: Ingresa datos del estudiante
    F->>F: Valida formulario
    F->>F: Genera c√≥digo QR √∫nico
    F->>S: INSERT estudiante
    S->>F: Confirma registro
    F->>F: Genera QR visual
    F->>U: Muestra QR descargable
```

### Workflow de Registro de Asistencia

```mermaid
sequenceDiagram
    participant S as Scanner
    participant F as Frontend
    participant DB as Supabase
    participant W as WhatsApp

    S->>F: Escanea c√≥digo QR
    F->>DB: Consulta estudiante
    DB->>F: Datos del estudiante
    F->>F: Determina tipo (entrada/salida)
    F->>DB: Verifica duplicados
    F->>DB: INSERT asistencia
    DB->>F: Confirma registro
    F->>S: Muestra confirmaci√≥n
    F->>W: Notificaci√≥n opcional WhatsApp
```

### Workflow de Control de Asistencia

```mermaid
sequenceDiagram
    participant P as Profesor/Directivo
    participant C as Control Panel
    participant DB as Supabase
    participant W as WhatsApp

    P->>C: Selecciona grado/secci√≥n
    C->>DB: Consulta estudiantes + asistencias
    DB->>C: Lista con estados
    C->>C: Calcula ausentes/tard√≠os
    C->>P: Muestra lista de ausentes
    P->>C: Env√≠a alerta a padre
    C->>W: Genera enlace WhatsApp
    W->>P: Abre chat con padre
```

---

## üîí Seguridad y Autenticaci√≥n

### Modelo de Seguridad

#### Autenticaci√≥n

- **Provider**: Supabase Auth
- **M√©todo**: Email/Password con JWT
- **Persistencia**: Sesi√≥n en localStorage
- **Expiraci√≥n**: Configurable en Supabase

#### Autorizaci√≥n

- **Nivel de aplicaci√≥n**: Context-based access control
- **Row Level Security (RLS)**: Configurado en Supabase
- **Roles**:
  - Profesor (acceso limitado a su grado/secci√≥n)
  - Directivo (acceso completo)
  - Administrador (gesti√≥n completa)

#### Pol√≠ticas de Seguridad RLS

```sql
-- Pol√≠tica para tabla alumnos
CREATE POLICY "Users can view students" ON alumnos
FOR SELECT USING (auth.role() = 'authenticated');

-- Pol√≠tica para tabla asistencias
CREATE POLICY "Users can insert attendance" ON asistencias
FOR INSERT WITH CHECK (auth.role() = 'authenticated');

CREATE POLICY "Users can view attendance" ON asistencias
FOR SELECT USING (auth.role() = 'authenticated');
```

#### Validaciones de Entrada

- **Frontend**: React Hook Form + Zod schemas
- **Backend**: Supabase constraints + triggers
- **QR Codes**: Validaci√≥n de formato √∫nico
- **Duplicados**: Constraints de base de datos

---

## üìä Manejo de Estado y Context

### Context API Structure

```typescript
// src/contexts/DashboardContext.tsx
interface DashboardContextType {
  // Estado global
  alumnos: Alumno[];
  asistencias: Asistencia[];
  estadisticas: EstadisticasGenerales;
  loading: boolean;
  error: string | null;

  // Funciones
  fetchAlumnos: () => Promise<void>;
  fetchAsistenciasHoy: () => Promise<void>;
  calcularEstadisticas: () => void;
}
```

### Hooks Personalizados

- **useWhatsAppNotification**: Gesti√≥n de notificaciones
- **useScannerLogic**: L√≥gica del scanner QR
- **useDashboard**: Acceso al contexto global

### Estado Local vs Global

- **Global**: Datos de estudiantes, asistencias, estad√≠sticas
- **Local**: Estados de UI, formularios, modales
- **Persist**: Preferencias de usuario, configuraciones

---

## üì± Integraci√≥n WhatsApp

### Implementaci√≥n Actual

- **Tipo**: WhatsApp Web Links
- **Formato**: `https://wa.me/PHONE?text=MESSAGE`
- **Codificaci√≥n**: URL encoding para caracteres especiales
- **Personalizaci√≥n**: Mensajes por tipo de notificaci√≥n

### Preparado para WhatsApp Business API

```typescript
// src/app/api/whatsapp/route.ts
export async function POST(req: NextRequest) {
  const { to, message } = await req.json();

  // Configurado para WhatsApp Business API
  const response = await fetch(
    `https://graph.facebook.com/v17.0/${PHONE_NUMBER_ID}/messages`,
    {
      method: "POST",
      headers: {
        Authorization: `Bearer ${ACCESS_TOKEN}`,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        messaging_product: "whatsapp",
        to,
        type: "text",
        text: { body: message },
      }),
    }
  );
}
```

---

## üìÑ Sistema de Reportes

### Formatos Disponibles

1. **PDF**: jsPDF con tablas autom√°ticas
2. **Excel**: XLSX con formato profesional
3. **CSV**: Para an√°lisis de datos

### Tipos de Reportes

- **Asistencia Diaria**: Por fecha espec√≠fica
- **Asistencia Semanal**: Rango de 7 d√≠as
- **Asistencia Mensual**: Por mes completo
- **Por Grado/Secci√≥n**: Filtrado espec√≠fico
- **Estudiantes Ausentes**: Lista de no asistentes

### Pipeline de Exportaci√≥n

```typescript
// src/utils/reportExports.ts
export const exportarAExcel = (
  data: ReportData,
  stats: EstadisticasReporte
) => {
  const workbook = XLSX.utils.book_new();
  const worksheet = XLSX.utils.json_to_sheet(data.asistencias);
  XLSX.utils.book_append_sheet(workbook, worksheet, "Asistencias");
  XLSX.writeFile(
    workbook,
    `reporte_${new Date().toISOString().split("T")[0]}.xlsx`
  );
};
```

---

## üé® Interfaz de Usuario y UX

### Design System

- **Paleta de Colores**: Azul corporativo (#07aee1)
- **Tipograf√≠a**: Geist Sans + Geist Mono
- **Componentes**: Sistema modular con Tailwind CSS
- **Iconograf√≠a**: Lucide React (set completo)

### Responsive Design

- **Mobile First**: Dise√±o prioritario para m√≥viles
- **Breakpoints**:
  - Mobile: < 768px
  - Tablet: 768px - 1024px
  - Desktop: > 1024px
- **PWA Ready**: Configurado para instalaci√≥n

### Accesibilidad

- **ARIA Labels**: En componentes interactivos
- **Keyboard Navigation**: Soporte completo
- **Color Contrast**: WCAG 2.1 AA compliant
- **Screen Readers**: Compatibilidad b√°sica

---

## üîß Configuraci√≥n y Deployment

### Variables de Entorno

```bash
# .env.local
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxx
WHATSAPP_ACCESS_TOKEN=xxx (futuro)
WHATSAPP_PHONE_NUMBER_ID=xxx (futuro)
```

### Scripts de Desarrollo

```json
{
  "dev": "next dev --turbopack",
  "build": "next build",
  "start": "next start",
  "lint": "next lint"
}
```

### Configuraci√≥n PWA

```json
// public/manifest.json
{
  "name": "Sistema de Control de Asistencia Educheck",
  "short_name": "Educheck",
  "display": "standalone",
  "theme_color": "#07aee1",
  "start_url": "/dashboard"
}
```

---

## üìà M√©tricas y Analytics

### KPIs del Sistema

- **Asistencia Diaria**: Porcentaje de presentes
- **Puntualidad**: Llegadas dentro del horario
- **Tendencias**: Comparativa semanal/mensual
- **Por Grado**: Estad√≠sticas segmentadas

### Datos en Tiempo Real

- **Registros**: Via Supabase Realtime
- **Notificaciones**: Toast system
- **Estados**: Context updates autom√°ticos

---

## üöÄ Roadmap y Funcionalidades Futuras

### En Desarrollo

- [ ] **API WhatsApp Business** integraci√≥n completa
- [ ] **Notificaciones Push** para ausencias autom√°ticas
- [ ] **Dashboard Administrativo** avanzado
- [ ] **Reportes Autom√°ticos** programados

### Planificado

- [ ] **App M√≥vil Nativa** (React Native)
- [ ] **Integraci√≥n con Sistema Acad√©mico**
- [ ] **ML para Predicci√≥n de Ausencias**
- [ ] **Geolocalizaci√≥n** para validar asistencia

---

## üîç Testing y Calidad

### Estrategia de Testing

- **Unit Tests**: Jest + React Testing Library
- **Integration Tests**: Cypress (planificado)
- **E2E Tests**: Playwright (planificado)
- **Manual Testing**: Protocolo definido

### Code Quality

- **TypeScript**: Strict mode habilitado
- **ESLint**: Configuraci√≥n Next.js + Custom rules
- **Prettier**: Formateo autom√°tico
- **Husky**: Pre-commit hooks (planificado)

---

## üìö Documentaci√≥n T√©cnica

### Estructura de Archivos

```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/          # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API Routes
‚îÇ   ‚îî‚îÄ‚îÄ globals.css        # Estilos globales
‚îú‚îÄ‚îÄ components/            # Componentes reutilizables
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/         # Componentes del dashboard
‚îÇ   ‚îî‚îÄ‚îÄ Scanner/           # Sistema de scanner QR
‚îú‚îÄ‚îÄ contexts/              # React Context
‚îú‚îÄ‚îÄ hooks/                 # Custom hooks
‚îú‚îÄ‚îÄ types/                 # TypeScript definitions
‚îî‚îÄ‚îÄ utils/                 # Utilidades y helpers
```

### Convenciones de C√≥digo

- **Nomenclatura**: PascalCase para componentes, camelCase para funciones
- **Imports**: Absolute paths con @ alias
- **Props**: Interfaces tipadas obligatorias
- **Async**: Async/await preferido sobre Promises

---

## üåü Conclusi√≥n

EduCheck Fe y Ciencia representa una soluci√≥n integral moderna para la gesti√≥n de asistencia escolar, combinando tecnolog√≠as web de vanguardia con procesos educativos tradicionales. El sistema est√° dise√±ado para escalabilidad, mantenibilidad y una experiencia de usuario excepcional.

### Fortalezas del Sistema

1. **Arquitectura Modular**: Facilita el mantenimiento y extensi√≥n
2. **Tecnolog√≠a Moderna**: Stack actualizado y performante
3. **UX Centrada en el Usuario**: Interfaz intuitiva y responsive
4. **Seguridad Robusta**: Implementaci√≥n de mejores pr√°cticas
5. **Integraci√≥n Flexible**: APIs preparadas para extensiones
6. **Documentaci√≥n Completa**: Base s√≥lida para desarrollo futuro

### Impacto Educativo

- **Automatizaci√≥n**: Reduce carga administrativa
- **Precisi√≥n**: Elimina errores manuales
- **Comunicaci√≥n**: Mejora contacto escuela-familia
- **An√°lisis**: Datos para toma de decisiones
- **Escalabilidad**: Preparado para crecimiento institucional

El proyecto establece las bases para un ecosistema digital educativo completo, con potencial para expandirse hacia otros aspectos de la gesti√≥n escolar.

---

_Documento generado el 18 de agosto de 2025_  
_Versi√≥n del Sistema: 0.1.0_  
_Estado: En Desarrollo Activo_
